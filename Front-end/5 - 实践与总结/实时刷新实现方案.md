
web开发中，经常遇到需要实时刷新数据的场景，例如即时聊天、新闻推送、数据监控等。
目前常用的实现方式共4种：

## 短轮询(Polling)

短轮询实现原理是，客户端设置定时器，每隔一定时间向服务端发送http请求，服务端收到请求后，不管是否有新数据，都进行响应，响应完成后即关闭本次TCP连接。客户端代码实现：

        setInterval(() => {
            fetch(url).then((res) => {
                // do something
            })
        }, 5000)

## 长轮询(Long-Polling)

长轮询实现原理是，客户端发送http请求，服务端收到请求后，判断是否有新数据：

* 若有，则进行响应，客户端收到响应后，渲染数据并发起新的请求；
* 若无，则服务端hold连接，请求处于pending状态，直到有数据或者超时才返回。

        refreshData() {
            fetch(url).then((res) => {
                // do something
                refreshData()
            }).catch((error) => {
                // do something
                refreshData()
            })
        }

## 长连接(iframe)

长连接实现原理是，在页面中插入一个隐藏的iframe标签，利用iframe的src属性在客户端与服务端之间建立一个长连接，服务端向iframe传输数据(通常是`<script>`标签包裹的js代码，动态将有效数据插入页面或更新页面)。

        // 前端
        <div id="refresh_wrap"></div>
        <iframe src="/get-refresh-data" style="display: none;"></iframe>

        // 后端
        if (hasRefreshData) {
            res.write(`
                <script type="text/javascript">
                    parent.document.getElementById('refresh_wrap').innerHTML = "${data}";  // 改变父窗口dom元素
                </script>
            `)
        }

## WebSocket

### what


## 比较